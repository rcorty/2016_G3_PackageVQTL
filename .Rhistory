my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.28*(my.cross$geno$`1`$data[,6] - 2)) # 0.3 too high, 0.27 a tiny bit too low
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = exp(0.23*(my.cross$geno$`2`$data[,6] - 2))) # 0.25 too high, 0.21 a tiny bit too low
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross),
mean = 0.24*(my.cross$geno$`3`$data[,6] - 2),       # 0.22, 0.15 a bit too low
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2)))
# make fig 1 -- LOD score scans
ymax <- 6
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(pa1 <- plot(x = a1, y = a0, ylim = c(0, ymax)))
b0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype2')
b1 <- scanonevar(cross = my.cross,
mean.formula = phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(pb1 <- plot(x = b1, y = b0, ylim = c(0, ymax)))
c0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype3')
c1 <- scanonevar(cross = my.cross,
mean.formula = phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(pc1 <- plot(x = c1, y = c0, ylim = c(0, ymax)))
d0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype4')
d1 <- scanonevar(cross = my.cross,
mean.formula = phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(pd1 <- plot(x = d1, y = d0, ylim = c(0, ymax)))
ggplot2::ggsave(plot = pa1, filename = 'images/LOD_scan_phen1.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pb1,	filename = 'images/LOD_scan_phen2.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pc1, filename = 'images/LOD_scan_phen3.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pd1, filename = 'images/LOD_scan_phen4.pdf', height = 2.5, width = 9)
# make fig 2 -- empirircal p-value scans
n.perms <- 1000
seed <- 27599
ymax <- 3.5
beep <- TRUE
system.time(a2 <- scanonevar.perm(sov = a1, n.perms = n.perms, random.seed = seed, n.cores = 3))
n.perms <- 1000
seed <- 27599
ymax <- 3.5
beep <- TRUE
# make fig 2 -- empirircal p-value scans
n.perms <- 1000
seed <- 27599
ymax <- 3.5
beep <- TRUE
system.time(a2 <- scanonevar.perm(sov = a1, n.perms = n.perms/5, random.seed = seed, n.cores = 3))
plot(pa2 <- plot(x = a2, ylim = c(0, ymax)))
if (beep) beepr::beep(sound = 2)
system.time(b2 <- scanonevar.perm(sov = b1, n.perms = n.perms, random.seed = seed, n.cores = 3))
plot(pb2 <- plot(x = b2, ylim = c(0, ymax)))
if (beep) beepr::beep(sound = 2)
system.time(c2 <- scanonevar.perm(sov = c1, n.perms = n.perms, random.seed = seed, n.cores = 3))
plot(pc2 <- plot(x = c2, ylim = c(0, ymax)))
if (beep) beepr::beep(sound = 2)
system.time(d2 <- scanonevar.perm(sov = d1, n.perms = n.perms, random.seed = seed, n.cores = 3))
plot(pd2 <- plot(x = d2, ylim = c(0, ymax)))
if (beep) beepr::beep(sound = 2)
ggplot2::ggsave(plot = pa2, filename = 'images/empir_p_scan_phen1.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pb2, filename = 'images/empir_p_scan_phen2.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pc2, filename = 'images/empir_p_scan_phen3.pdf', height = 2.5, width = 9)
ggplot2::ggsave(plot = pd2, filename = 'images/empir_p_scan_phen4.pdf', height = 2.5, width = 9)
formula(x ~ y)
z <- 'x'
formula(paste(z, '~ y'))
?scanone
library(tidyr); library(dplyr); library(qtl); library(vqtl);
set.seed(27599)
# simulate the cross
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 11, eq.spacing = TRUE, include.x = FALSE, anchor.tel = TRUE),
n.ind = 400,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 200)
my.cross <- qtl::calc.genoprob(cross = my.cross, step = 2)
# simulate phenotype1 through phenotype4, for the body of the paper
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.28*(my.cross$geno$`1`$data[,6] - 2)) # 0.3 too high, 0.27 a tiny bit too low
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = exp(0.23*(my.cross$geno$`2`$data[,6] - 2))) # 0.25 too high, 0.21 a tiny bit too low
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross),
mean = 0.24*(my.cross$geno$`3`$data[,6] - 2),       # 0.22, 0.15 a bit too low
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2)))
# simulate phenotype1x through phenotype4x, for the appendix
my.cross$pheno$phenotype1x <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2x <- rnorm(n = qtl::nind(my.cross),
mean = 0.26*(my.cross$geno$`1`$data[,6] - 2),
sd = exp(my.cross$pheno$sex - 0.5))
my.cross$pheno$phenotype3x <- rnorm(n = qtl::nind(my.cross),
sd = exp(0.21*(my.cross$geno$`2`$data[,6] - 2) + (my.cross$pheno$sex - 0.5)))
my.cross$pheno$phenotype4x <- rnorm(n = qtl::nind(my.cross),
mean = 0.2*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.15*(my.cross$geno$`3`$data[,6] - 2) + (my.cross$pheno$sex - 0.5)))
focal.phen.name <- 'phenotype1'
so <- qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex)
perms <-  qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex,
n.perm = 50)
the.evd <- evd::fgev(x = perms)
so
head(so)
str(so)
fitted(the.evd)
so$empir.p <- evd::pgev(q = so$lod,
loc = fitted(the.evd)[1],
scale = fitted(the.evd)[2],
shape = fitted(the.evd)[3],
lower.tail = FALSE)
plot(so)
plot(x = so, lodcolumn = 1)
plot(x = so, lodcolumn = 2)
names(so)
so$empir.p <- evd::pgev(q = so$lod,
loc = fitted(the.evd)[1],
scale = fitted(the.evd)[2],
shape = fitted(the.evd)[3],
lower.tail = FALSE)
sovp <- scanonevar.perm(sov = sov, n.perms = 20, random.seed = 27599, n.cores = 3)
# do a genome scan, then permutations to assess significance
so <- qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex)
sov <- scanonevar(cross = my.cross,
mean.formula = formula(paste(focal.phen.name, '~ sex + mean.QTL.add + mean.QTL.dom')),
var.formula = ~sex + var.QTL.add + var.QTL.dom)
p1 <- plot(x = sov, y = so, ylim = c(0, 6))
perms <-  qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex,
n.perm = 50,
verbose = FALSE)
the.evd <- evd::fgev(x = perms)
so$empir.p <- evd::pgev(q = so$lod,
loc = fitted(the.evd)[1],
scale = fitted(the.evd)[2],
shape = fitted(the.evd)[3],
lower.tail = FALSE)
sovp <- scanonevar.perm(sov = sov, n.perms = 20, random.seed = 27599, n.cores = 3)
p2 <- plot(x = sovp, y = so, ylim = c(0, 3.5))
p2
focal.phen.name <- 'phentype2'
so <- qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex)
sov <- scanonevar(cross = my.cross,
mean.formula = formula(paste(focal.phen.name, '~ sex + mean.QTL.add + mean.QTL.dom')),
var.formula = ~sex + var.QTL.add + var.QTL.dom)
p1 <- plot(x = sov, y = so, ylim = c(0, 6))
focal.phen.name <- 'phenotype2'
so <- qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex)
sov <- scanonevar(cross = my.cross,
mean.formula = formula(paste(focal.phen.name, '~ sex + mean.QTL.add + mean.QTL.dom')),
var.formula = ~sex + var.QTL.add + var.QTL.dom)
p1 <- plot(x = sov, y = so, ylim = c(0, 6))
p1
perms <-  qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex,
n.perm = 50,
verbose = FALSE)
the.evd <- evd::fgev(x = perms)
so$empir.p <- evd::pgev(q = so$lod,
loc = fitted(the.evd)[1],
scale = fitted(the.evd)[2],
shape = fitted(the.evd)[3],
lower.tail = FALSE)
sovp <- scanonevar.perm(sov = sov, n.perms = 20, random.seed = 27599, n.cores = 3)
p2 <- plot(x = sovp, y = so, ylim = c(0, 3.5))
p2
ls()
focal.phen.name <- 'phenotype2x'
library(tidyr); library(dplyr); library(qtl); library(vqtl);
set.seed(27599)
# simulate the cross
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 11, eq.spacing = TRUE, include.x = FALSE, anchor.tel = TRUE),
n.ind = 400,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 200)
my.cross <- qtl::calc.genoprob(cross = my.cross, step = 2)
# simulate phenotype1 through phenotype4, for the body of the paper
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = 1)
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross),
mean = 0.28*(my.cross$geno$`1`$data[,6] - 2),
sd = 1)
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(0.23*(my.cross$geno$`2`$data[,6] - 2)))
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross),
mean = 0.24*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2)))
# simulate phenotype1x through phenotype4x, for the appendix
my.cross$pheno$phenotype1x <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(my.cross$pheno$sex - 0.5))
my.cross$pheno$phenotype2x <- rnorm(n = qtl::nind(my.cross),
mean = 0.26*(my.cross$geno$`1`$data[,6] - 2),
sd = exp(my.cross$pheno$sex - 0.5))
my.cross$pheno$phenotype3x <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(0.21*(my.cross$geno$`2`$data[,6] - 2) + (my.cross$pheno$sex - 0.5)))
my.cross$pheno$phenotype4x <- rnorm(n = qtl::nind(my.cross),
mean = 0.2*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.15*(my.cross$geno$`3`$data[,6] - 2) + (my.cross$pheno$sex - 0.5)))
# do a genome scan, then permutations to assess significance
so <- qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex)
sov <- scanonevar(cross = my.cross,
mean.formula = formula(paste(focal.phen.name, '~ sex + mean.QTL.add + mean.QTL.dom')),
var.formula = ~sex + var.QTL.add + var.QTL.dom)
p1 <- plot(x = sov, y = so, ylim = c(0, 6))
ggplot2::ggsave(plot = p1, height = 2.5, width = 9,
filename = paste0('images/LOD_scan_', focal.phen.name,'.pdf'))
message('Done with so and sov')
p1
sov$meta
ls()
focal.phen.name
plot(sov)
perms <-  qtl::scanone(cross = my.cross,
pheno.col = focal.phen.name,
addcovar = my.cross$pheno$sex,
n.perm = 1000,
verbose = FALSE)
the.evd <- evd::fgev(x = perms)
so$empir.p <- evd::pgev(q = so$lod,
loc = fitted(the.evd)[1],
scale = fitted(the.evd)[2],
shape = fitted(the.evd)[3],
lower.tail = FALSE)
message('Done with so perms')
sovp <- scanonevar.perm(sov = sov, n.perms = 20, random.seed = 27599, n.cores = 3)
plot(x = sovp, y = so, ylim = c(0, 3.5))
so
head(so)
plot(x = so$lod)
points(x = 1:100, y = so$empir.p)
points(x = 1:nrow(so), y = so$empir.p)
points(x = 1:nrow(so), y = -log10(so$empir.p))
plot(x = so$lod)
points(x = 1:nrow(so), y = -log10(so$empir.p))
library(tidyr); library(dplyr); library(qtl); library(vqtl);
set.seed(27599)
# simulate the cross
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 11, eq.spacing = TRUE, include.x = FALSE, anchor.tel = TRUE),
n.ind = 400,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 200)
my.cross <- qtl::calc.genoprob(cross = my.cross, step = 2)
# simulate phenotype1 through phenotype4, for the body of the paper
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = 1)
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross),
mean = 0.28*(my.cross$geno$`1`$data[,6] - 2),
sd = 1)
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(0.23*(my.cross$geno$`2`$data[,6] - 2)))
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross),
mean = 0.24*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2)))
# simulate phenotype1x through phenotype4x, for the appendix
my.cross$pheno$phenotype1x <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(my.cross$pheno$sex - 0.5))
my.cross$pheno$phenotype2x <- rnorm(n = qtl::nind(my.cross),
mean = 0.2*(my.cross$geno$`1`$data[,6] - 2) + 0.2*(my.cross$pheno$sex - 0.5),
sd = exp(0.2*(my.cross$pheno$sex - 0.5)))
my.cross$pheno$phenotype3x <- rnorm(n = qtl::nind(my.cross),
mean = 0.2*(my.cross$pheno$sex - 0.5),
sd = exp(0.17*(my.cross$geno$`2`$data[,6] - 2) + 0.2*(my.cross$pheno$sex - 0.5)))
my.cross$pheno$phenotype4x <- rnorm(n = qtl::nind(my.cross),
mean = 0.15*(my.cross$geno$`3`$data[,6] - 2) + 0.2*(my.cross$pheno$sex - 0.5),
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2) + 0.2*(my.cross$pheno$sex - 0.5)))
#### SIMULATE CROSS AND PHENOTYPES ####
library(tidyr); library(dplyr); library(qtl); library(vqtl);
set.seed(27599)
# simulate the cross
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 11, eq.spacing = TRUE, include.x = FALSE, anchor.tel = TRUE),
n.ind = 400,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 200)
my.cross$pheno$batch <- sample(x = 10, size = 400, replace = TRUE)
my.cross <- qtl::calc.genoprob(cross = my.cross, step = 2)
batch.effects <- runif(n = 10, min = -0.5, max = 0.5)
# simulate phenotype1 through phenotype4, for the body of the paper
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = 1)
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross),
mean = 0.28*(my.cross$geno$`1`$data[,6] - 2),
sd = 1)
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(0.23*(my.cross$geno$`2`$data[,6] - 2)))
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross),
mean = 0.24*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.16*(my.cross$geno$`3`$data[,6] - 2)))
# simulate phenotype1x through phenotype4x, for the appendix
my.cross$pheno$phenotype1x <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(my.cross$pheno$sex - 0.5))
my.cross$pheno$phenotype2x <- rnorm(n = qtl::nind(my.cross),
mean = 0.48*(my.cross$geno$`1`$data[,6] - 2),
sd = exp(0.5*batch.effects[my.cross$pheno$batch]))
my.cross$pheno$phenotype3x <- rnorm(n = qtl::nind(my.cross),
mean = 0,
sd = exp(0.24*(my.cross$geno$`2`$data[,6] - 2) + 0.5*(batch.effects[my.cross$pheno$batch])))
my.cross$pheno$phenotype4x <- rnorm(n = qtl::nind(my.cross),
mean = 0.21*(my.cross$geno$`3`$data[,6] - 2),
sd = exp(0.12*(my.cross$geno$`3`$data[,6] - 2) + 0.2*(batch.effects[my.cross$pheno$batch])))
xlims <- c(-0.3, 0.5)
ylims <- c(0.6, 1.6)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6',
xlim = xlims,
ylim = ylims))
p1
p2
xlims <- c(-0.5, 0.5)
ylims <- c(0.6, 1.6)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6',
xlim = xlims,
ylim = ylims))
p1
p2
p3
p4
xlims <- c(-0.5, 0.3)
ylims <- c(0.6, 1.6)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6',
xlim = xlims,
ylim = ylims))
p1
p2
p3
p4
p1$scales$scales
p1$scales$super$scales
p1$coordinates$limits
sapply(X = c(p1, p2, p3, p4), FUN = .[['coordinates']])
sapply(X = c(p1, p2, p3, p4), FUN = function(p) p[['coordinates']])
sapply(X = c(p1, p2, p3, p4), FUN = function(p) p[['coordinates']][['limits']])
sapply(X = list(p1, p2, p3, p4), FUN = function(p) p[['coordinates']][['limits']])
lapply(X = list(p1, p2, p3, p4), FUN = function(p) p[['coordinates']][['limits']])
lapply(X = list(p1, p2, p3, p4), FUN = function(p) p[['coordinates']][['limits']][['x']])
p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1',
focal.covariate.names = 'D1M1')
p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2',
focal.covariate.names = 'D1M6')
p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3',
focal.covariate.names = 'D2M6')
p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6')
lapply(X = list(p1, p2, p3, p4), FUN = function(p) p[['coordinates']][['limits']][['x']])
xlims <- c(-0.5, 0.3)
ylims <- c(0.6, 1.5)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6',
xlim = xlims,
ylim = ylims))
mean(my.cross$pheno$phenotype1)
mean(my.cross$pheno$phenotype2)
mean(my.cross$pheno$phenotype3)
mean(my.cross$pheno$phenotype4)
mean(my.cross$pheno$phenotype1x)
mean(my.cross$pheno$phenotype2x)
mean(my.cross$pheno$phenotype3x)
mean(my.cross$pheno$phenotype4x)
ggplot2::ggsave(plot = p1, filename = 'images/mean_var_plot_phen1.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p2, filename = 'images/mean_var_plot_phen2.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p3, filename = 'images/mean_var_plot_phen3.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p4, filename = 'images/mean_var_plot_phen4.pdf', height = 3, width = 4)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1x',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
xlims <- c(-0.3, 0.5)
ylims <- c(0.6, 1.6)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1x',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2x',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
xlims <- c(-0.4, 0.5)
ylims <- c(0.6, 1.6)
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1x',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2x',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3x',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p1 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype1x',
focal.covariate.names = 'D1M1',
xlim = xlims,
ylim = ylims))
plot(p2 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype2x',
focal.covariate.names = 'D1M6',
xlim = xlims,
ylim = ylims))
plot(p3 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype3x',
focal.covariate.names = 'D2M6',
xlim = xlims,
ylim = ylims))
plot(p4 <- mean_var_plot_model_based(cross = my.cross,
phenotype.name = 'phenotype4',
focal.covariate.names = 'D3M6',
xlim = xlims,
ylim = ylims))
ggplot2::ggsave(plot = p1, filename = 'images/mean_var_plot_phen1x.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p2, filename = 'images/mean_var_plot_phen2x.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p3, filename = 'images/mean_var_plot_phen3x.pdf', height = 3, width = 4)
ggplot2::ggsave(plot = p4, filename = 'images/mean_var_plot_phen4x.pdf', height = 3, width = 4)
