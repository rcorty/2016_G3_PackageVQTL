plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.8*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = my.cross$geno$`3`$data[,15], sd = my.cross$geno$`3`$data[,15])
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = 100)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = 100)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = 100)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = 100)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/LOD_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 10)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.8*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = my.cross$geno$`3`$data[,15], sd = my.cross$geno$`3`$data[,15])
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.8*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = my.cross$geno$`3`$data[,15], sd = my.cross$geno$`3`$data[,15])
n.perms <- 500
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/LOD_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
d1r
c1r
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.7*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = 0.8*my.cross$geno$`3`$data[,15], sd = 0.8*my.cross$geno$`3`$data[,15])
n.perms <- 50
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/LOD_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = 0.5*my.cross$geno$`3`$data[,15], sd = my.cross$geno$`3`$data[,15])
n.perms <- 50
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/p_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.3*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,15], sd = 0.5*my.cross$geno$`3`$data[,15])
n.perms <- 50
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/p_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = 0.5*my.cross$geno$`3`$data[,15], sd = 0.5*my.cross$geno$`3`$data[,15])
n.perms <- 100
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/p_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- sim.cross(map = sim.map(len = rep(100, 4), n.mar = 30, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,15])
my.cross$pheno$phenotype3 <- rnorm(n = nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,15])
my.cross$pheno$phenotype4 <- rnorm(n = nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,15], sd = 0.3*my.cross$geno$`3`$data[,15])
n.perms <- 100
a1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
a1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
a1p <- scanonevar.to.p.values(scanonevar = a1, perm.scan.maxes = a1r)
b1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
b1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype2 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
b1p <- scanonevar.to.p.values(scanonevar = b1, perm.scan.maxes = b1r)
c1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
c1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype3 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
c1p <- scanonevar.to.p.values(scanonevar = c1, perm.scan.maxes = c1r)
d1 <- scanonevar(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
return.models = TRUE)$varscan
d1r <- scanonevar.perm(cross = my.cross,
mean.formula = 'phenotype4 ~ sex + mean.QTL.add + mean.QTL.dom',
var.formula = '~sex + var.QTL.add + var.QTL.dom',
n.perms = n.perms)
d1p <- scanonevar.to.p.values(scanonevar = d1, perm.scan.maxes = d1r)
# pdf(file = '../2016_G3_PackageVQTL_Corty/images/p_scans.pdf', width = 6, height = 8)
par(mfrow = c(4, 1), mar = c(3.1, 3.1, 3.1, 2.1))
ylim <- c(0, 12)
plot(x = a1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = b1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = c1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5, suppress.chromosome = TRUE)
plot(x = d1p, show.equations = FALSE, legend.pos = 'right', legend.ncol = 1, ylim = ylim, title.cex = 1.2, line.width = 1.5)
# dev.off()
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 20, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- qtl::calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,10])
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,10])
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,10], sd = 0.3*my.cross$geno$`3`$data[,10])
n.perms <- 100
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(x = a1, y = a0)
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 20, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- qtl::calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,10])
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,10])
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,10], sd = 0.3*my.cross$geno$`3`$data[,10])
n.perms <- 100
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(x = a1, y = a0)
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 20, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- qtl::calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,10])
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,10])
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,10], sd = 0.3*my.cross$geno$`3`$data[,10])
n.perms <- 100
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(x = a1, y = a0)
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 20, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- qtl::calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,10])
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,10])
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,10], sd = 0.3*my.cross$geno$`3`$data[,10])
n.perms <- 100
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(x = a1, y = a0)
library(tidyr); library(dplyr); library(vqtl)
set.seed(27599)
my.cross <- qtl::sim.cross(map = qtl::sim.map(len = rep(100, 3), n.mar = 20, eq.spacing = TRUE, include.x = FALSE),
n.ind = 200,
type = 'f2')
my.cross$pheno$sex <- rep(x = c(0, 1), each = 100)
my.cross <- qtl::calc.genoprob(my.cross)
my.cross$pheno$phenotype1 <- rnorm(n = qtl::nind(my.cross))
my.cross$pheno$phenotype2 <- rnorm(n = qtl::nind(my.cross), mean = 0.5*my.cross$geno$`1`$data[,10])
my.cross$pheno$phenotype3 <- rnorm(n = qtl::nind(my.cross), sd = 0.5*my.cross$geno$`2`$data[,10])
my.cross$pheno$phenotype4 <- rnorm(n = qtl::nind(my.cross), mean = 0.3*my.cross$geno$`3`$data[,10], sd = 0.3*my.cross$geno$`3`$data[,10])
n.perms <- 100
a0 <- qtl::scanone(cross = my.cross,
pheno.col = 'phenotype1')
a1 <- scanonevar(cross = my.cross,
mean.formula = phenotype1 ~ sex + mean.QTL.add + mean.QTL.dom,
var.formula = ~sex + var.QTL.add + var.QTL.dom)
plot(x = a1, y = a0)
library(vqtl)
